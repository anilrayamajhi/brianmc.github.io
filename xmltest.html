
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>ANet API XML Test</title>
  <style type="text/css">
  .header {
    font-size:larger;
    font-weight:bold;
  }
  .error {
    color:#ff0000;
  }
  </style>
<script language="javascript" type="text/javascript">
// <!CDATA[
function XHConn()
{
  var xmlhttp, bComplete = false;
  try { xmlhttp = new ActiveXObject("Msxml2.XMLHTTP"); }
  catch (e) { try { xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); }
  catch (e) { try { xmlhttp = new XMLHttpRequest(); }
  catch (e) { xmlhttp = false; }}}
  if (!xmlhttp) return null;
  this.connect = function(sURL, sPostData, fnDone)
  {
    if (!xmlhttp) return false;
    bComplete = false;

    try {
      xmlhttp.open("POST", sURL, true);
      xmlhttp.setRequestHeader("Method", "POST "+sURL+" HTTP/1.1");
      xmlhttp.setRequestHeader("Content-Type", "text/xml");
      xmlhttp.onreadystatechange = function(){
        if (xmlhttp.readyState == 4 && !bComplete)
        {
          bComplete = true;
          fnDone(xmlhttp);
        }
      };
      xmlhttp.send(sPostData);
    }
    catch(z) {
      alert(z);
      return false;
    }
    return true;
  };
  return this;
}

var g_xc = new XHConn();

function btnSend_onclick() {
  document.getElementById("btnSend").disabled = true;
  document.getElementById("txtRespXml").innerHTML = "";
  document.getElementById("spnStatusCode").innerHTML = "";
  var fnWhenDone = function (oXML) {
    if (oXML.status && oXML.status != "200") {
      document.getElementById("spnStatusCode").innerHTML = "HTTP status code: " + oXML.status.toString().replace(/</g, "&lt;");
    }
    var txt = oXML.responseText;
    txt = txt.replace(/></g, "> <");
    txt = txt.replace(/</g, "&lt;");
    txt = txt.replace(/>/g, "&gt;");
    document.getElementById("txtRespXml").innerHTML = txt;
    document.getElementById("btnSend").disabled = false;
  };
  g_xc.connect(document.getElementById("txtUrl").value, document.getElementById("txtReqXml").value, fnWhenDone);
}

function selUrls_onChange(obj) {
  if (document.getElementById("selUrls").value) {
    document.getElementById("txtUrl").value = document.getElementById("selUrls").value;
  }
}

// ]]>
</script>
</head>
<body>
  <div style="padding-bottom:20px;">Please note: this page is for demonstration purposes only. It is not intended to be used for anything else.</div>
  <form method="post" action="">
    <div><span class="header">API Url:</span></div>
    <p>
      <input type="text" id="txtUrl" name="txtUrl" size="55" value="request.api" />
      &nbsp;&nbsp;<select name="selUrls" id="selUrls" onchange="selUrls_onChange(this)" onblur="selUrls_onChange(this)">
        <option value="">--Alternate Url--</option>
        <option value="request.api">ANetApi</option>
        <option value="reseller.api">ANetApi for resellers</option>
      </select>
    </p>
    <div>
      <span class="header">Request XML:</span>
      <span style="font-size:smaller">
        &nbsp;&nbsp;<a href="http://developer.authorize.net/resources/files/samplecode/xml_arb.zip">ARB XML examples.zip</a>
        &nbsp;&nbsp;<a href="http://developer.authorize.net/resources/files/samplecode/xml_cim.zip">CIM XML examples.zip</a>
        &nbsp;&nbsp;<a href="http://developer.authorize.net/resources/files/samplecode/xml_mbapi.zip">MBAPI XML examples.zip</a>
        &nbsp;&nbsp;<a href="http://developer.authorize.net/samplecode/">More sample code</a>
      </span>
    </div>
    <p>
      <textarea id="txtReqXml" name="txtReqXml" cols="80" rows="16" style="">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;isAliveRequest xmlns="AnetApi/xml/v1/schema/AnetApiSchema.xsd"&gt;
    &lt;refId&gt;refid1&lt;/refId&gt;
&lt;/isAliveRequest&gt;</textarea>
    </p>
    <p>
      <input type="button" id="btnSend" name="btnSend" value="Send" onclick="return btnSend_onclick()" />
      <span style="font-size:smaller;">Click here to send the XML request.</span>
    </p>
    <div><span class="header">Response:</span> <span id="spnStatusCode" class="error"></span></div>
    <p>
      <textarea id="txtRespXml" name="txtRespXml" cols="80" rows="10"></textarea>
    </p>
  </form>
</body>
</html>
